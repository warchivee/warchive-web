import{r as p,j as a,c as g,B as v,T as f,R as b,a as C,I as k,b as j,d as w}from"./index-tPtzejpP.js";import{s as N,w as _,t as $,a as I,I as B,W as P}from"./index-8hRp1WYH.js";const T=(e,s)=>{const[t,r]=p.useState(1),c=Math.ceil(e.length/s),l=o=>{r(Math.max(1,Math.min(o,c)))};return[e.slice((t-1)*s,t*s),t,c,l]},E=T,L=(e,s)=>{const r=Math.max(1,Math.min(e-2,s-5+1)),c=Math.min(r+5-1,s);return Array.from({length:c-r+1},(d,o)=>r+o)};function M({currentPage:e,maxPage:s,onChange:t=()=>{}}){var r;return a.jsxs("div",{className:"pagination",children:[a.jsx("div",{className:g("control",{hidden:e<=3}),children:a.jsx(v,{icon:"angles-left",onClick:()=>{t(1)}})}),a.jsx("div",{className:"pages",children:(r=L(e,s))==null?void 0:r.map(c=>a.jsx("div",{className:g({active:c===e}),onClick:()=>{t(c)},"aria-hidden":"true",children:a.jsx(f,{size:"big",children:c})},`page-${c}`))}),a.jsx("div",{className:g("control",{hidden:e+2>=s}),children:a.jsx(v,{icon:"angles-right",onClick:()=>{t(s)}})})]})}const R=(e,s)=>e.filter(t=>t.value!==s.value),W=(e,s)=>[...e,s],z=()=>{const[e,s]=b(N);return{searchKeywords:e,updateSearchKeywords:(l,d)=>{const n=e[l].some(m=>m.value===d.value)?R:W;s({...e,[l]:n(e[l],d)})},resetSearchKeywords:l=>{s({searchInput:"",category:l||e.category,genres:[],platforms:[],keywords:[]})},hasSelectedKeywords:()=>e.genres.length!==0||e.platforms.length!==0||e.keywords.length!==0}},A=(e,s,t)=>{const r={genres:[],platforms:[],keywords:[]},{genre_list:c,platform_list:l,keyword_list:d}=t;return c==null||c.forEach(o=>{e!=null&&e.some(n=>s===n.category.label&&n.genre.label===o)&&r.genres.push({value:`genre-${o}`,label:o})}),l==null||l.forEach(o=>{e!=null&&e.some(n=>s===n.category.label&&n.platforms.some(m=>m.label===o))&&r.platforms.push({value:`platform-${o}`,label:o})}),d==null||d.forEach(o=>{e!=null&&e.some(n=>s===n.category.label&&n.keywords.some(m=>m.label===o))&&r.keywords.push({value:`keyword-${o}`,label:o})}),r},O=C({key:"keywordListState",get:async({get:e})=>{const s=e(_),{allKeyword_list:t}=$,{category_list:r,genre_list:c,platform_list:l,keyword_list:d}=t,o=r==null?void 0:r.map(n=>({value:`category-${n}`,label:n,...A(s,n,t)}));return o.unshift({value:"category-전체",label:"전체",genres:c.map(n=>({label:n,value:`genre-${n}`})),platforms:l.map(n=>({label:n,value:`platform-${n}`})),keywords:d.map(n=>({label:n,value:`keyword-${n}`}))}),o}});function K({value:e="keyword-1",label:s="키워드",type:t="default",size:r="normal",checked:c=!1,onChange:l=()=>{}}){return a.jsxs("div",{className:"bubble",children:[a.jsx("input",{type:"checkbox",name:e,id:e,checked:c,onChange:l}),a.jsxs("label",{htmlFor:e,className:g({[`${t}`]:t}),children:[a.jsx(f,{size:r,children:s}),t==="remove"&&a.jsx(k,{type:"xmark",size:r,color:"french-lilac"})]})]})}function D({title:e,bubbles:s=[],bubbleType:t,selectedBubbles:r=[],handleChange:c=()=>{}}){return a.jsxs("div",{className:"bubbles",children:[a.jsx(j,{type:"h4",color:"french-lilac",children:e}),a.jsx("div",{className:"grid",children:s==null?void 0:s.map(l=>a.jsx(K,{value:l.value,label:l.label,checked:r.some(d=>d.value===l.value),onChange:()=>c(t,l)},`bubble-${l.value}`))})]})}function F(){const e=w(O),[s,t]=p.useState(0),[r,c]=p.useState(!1),{searchKeywords:l,updateSearchKeywords:d,resetSearchKeywords:o,hasSelectedKeywords:n}=z(),m=i=>{const h=s===i;h||o({label:e[i].label,value:e[i].value}),t(h?s:i),c(h?!r:!0)},x=(i,h,u,S)=>a.jsx(D,{title:h,bubbleType:u,bubbles:S,selectedBubbles:l[u],handleChange:d},`${i}-${h}`),y=(i,h)=>i==null?void 0:i.map(u=>a.jsx(K,{value:`selected-${u.value}`,label:u.label,type:"remove",onChange:()=>{d(h,u)}},u.value));return a.jsxs("div",{className:"keyword-search-board",children:[a.jsxs("div",{className:"tabs",children:[a.jsxs("div",{className:"control",onClick:()=>{c(!r)},"aria-hidden":"true",children:[a.jsx(j,{type:"h5",color:"white",children:"키워드로 검색"}),a.jsx(k,{size:"small",color:"white",type:r?"up":"down"})]}),e==null?void 0:e.map((i,h)=>a.jsx("div",{className:g("tab",{select:s===h}),onClick:()=>m(h),"aria-hidden":"true",children:a.jsx(j,{type:"h4",color:"white",children:i.label})},i.value))]}),a.jsx("div",{className:g("panel-background",{hidden:!r}),children:a.jsxs("div",{className:"panel",children:[x(e[s].value,"장르","genres",e[s].genres),a.jsx("div",{className:"driven"}),x(e[s].value,"플랫폼","platforms",e[s].platforms),a.jsx("div",{className:"driven"}),x(e[s].value,"키워드","keywords",e[s].keywords)]})}),r||n()?a.jsxs("div",{className:"select-keywords",children:[a.jsxs("div",{className:"keywords",children:[y(l.genres,"genres"),y(l.platforms,"platforms"),y(l.keywords,"keywords")]}),n()&&a.jsx(v,{background:"lavender",labelColor:"french-lilac",border:"round",size:"small",onClick:()=>{o()},children:"검색 초기화"})]}):null]})}function G(){const e=w(I),[s,t]=b(N),[r,c,l,d]=E(e,20);return p.useEffect(()=>{d(1)},[s]),a.jsxs("div",{className:"page home",children:[a.jsx(F,{}),a.jsxs("div",{className:"content",children:[a.jsx("div",{className:"searchbar",children:a.jsx(B,{value:s.searchInput,type:"search",placeholder:"제목/작가/감독명으로 검색",onChange:o=>{t({...s,searchInput:o})}})}),a.jsxs(f,{size:"big",children:["검색 결과는 총 ",e.length," 개 입니다."]}),a.jsx(P,{watas:r}),a.jsx(M,{currentPage:c,onChange:d,maxPage:l})]})]})}export{G as default};
